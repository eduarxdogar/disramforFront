<div *ngIf="pedido">
  <mat-card class="p-6 shadow rounded-lg" id="orden">
    <mat-card-title class="text-2xl font-bold mb-4">Orden de Pedido #{{ pedido.id }}</mat-card-title>
    <mat-card-content class="space-y-2">
      <p><strong>Fecha:</strong> {{ pedido.fecha | date:'short' }}</p>
      <p><strong>Cliente:</strong> {{ pedido.clienteNombre }} (NIT: {{ pedido.clienteNit }})</p>
      <p><strong>Ciudad de entrega:</strong> {{ pedido.ciudadEntrega }}</p>
      <p><strong>Dirección de entrega:</strong> {{ pedido.direccionEntrega }}</p>
      <p><strong>Asesor:</strong> {{ pedido.asesor }}</p>
      <p><strong>Estado:</strong> {{ pedido.estado }}</p>
      <p><strong>Total sin IVA:</strong> {{ pedido.total | currency:'COP' }}</p>
      <p><strong>IVA ({{ ivaPct }}%):</strong> {{ (pedido.total * ivaPct / 100) | currency:'COP' }}</p>
      <p class="text-xl font-semibold"><strong>Total con IVA:</strong> {{ (pedido.total * (1 + ivaPct / 100)) | currency:'COP' }}</p>
      <p><strong>Entrega estimada en:</strong> {{ entregaDias }} días</p>
    </mat-card-content>
  </mat-card>

  <!-- Tabla de ítems -->
  <mat-card class="mt-6 shadow rounded-lg">
    <mat-card-title>Detalle de Productos</mat-card-title>
    <mat-card-content>
      <table class="w-full table-auto mt-4">
        <thead class="bg-gray-100">
          <tr>
            <th class="p-2 border">Código</th>
            <th class="p-2 border">Descripción</th>
            <th class="p-2 border">Cantidad</th>
            <th class="p-2 border text-right">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let it of pedido.items" class="hover:bg-gray-50">
            <td class="p-2 border">{{ it.productoCodigo }}</td>
            <td class="p-2 border">{{ it.productoNombre }}</td>
            <td class="p-2 border text-center">{{ it.cantidad }}</td>
            <td class="p-2 border text-right">{{ it.subtotal | currency:'COP' }}</td>
          </tr>
        </tbody>
      </table>
    </mat-card-content>
  </mat-card>

  <!-- Botones de exportación -->
  <div class="mt-6 flex justify-end space-x-2">
    <button mat-flat-button color="primary" (click)="exportPDF()">
      <mat-icon>picture_as_pdf</mat-icon> Exportar PDF
    </button>
    <button mat-flat-button color="accent" (click)="exportXLS()">
      <mat-icon>table_view</mat-icon> Exportar Excel
    </button>
  </div>
</div>
