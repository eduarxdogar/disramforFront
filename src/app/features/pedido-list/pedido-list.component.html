<div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
        <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">Historial de Pedidos</h1>
        <button mat-flat-button color="primary" routerLink="/nuevo-pedido">
            <mat-icon class="mr-2">add</mat-icon>
            <span>Crear Nuevo Pedido</span>
        </button>
    </div>

    <div class="mat-elevation-z8 bg-white rounded-lg overflow-hidden">
        <table mat-table [dataSource]="dataSource" class="w-full">

            <!-- Columna ID -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef class="p-4"> # Pedido </th>
                <td mat-cell *matCellDef="let p" class="p-4 font-medium"> {{p.id}} </td>
            </ng-container>

            <!-- Columna Fecha -->
            <ng-container matColumnDef="fecha">
                <th mat-header-cell *matHeaderCellDef class="p-4"> Fecha </th>
                <td mat-cell *matCellDef="let p" class="p-4"> {{p.fecha | date:'dd/MM/yyyy h:mm a'}} </td>
            </ng-container>

            <!-- Columna Cliente -->
            <ng-container matColumnDef="clienteNombre">
                <th mat-header-cell *matHeaderCellDef class="p-4"> Cliente </th>
                <td mat-cell *matCellDef="let p" class="p-4"> {{p.clienteNombre}} </td>
            </ng-container>
            
            <!-- Columna Asesor -->
            <ng-container matColumnDef="asesorNombre">
                <th mat-header-cell *matHeaderCellDef class="p-4"> Asesor </th>
                <td mat-cell *matCellDef="let p" class="p-4"> {{p.asesorNombre}} </td>
            </ng-container>

            <!-- Columna Total -->
            <ng-container matColumnDef="total">
                <th mat-header-cell *matHeaderCellDef class="p-4 text-right"> Total </th>
                <td mat-cell *matCellDef="let p" class="p-4 text-right font-semibold"> {{p.total | currency:'COP':'symbol-narrow':'1.0-0'}} </td>
            </ng-container>

            <!-- Columna Estado -->
            <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef class="p-4 text-center"> Estado </th>
                <td mat-cell *matCellDef="let p" class="p-4 text-center">
                    <span class="px-2 py-1 text-xs font-semibold rounded-full"
                          [ngClass]="{
                            'bg-yellow-100 text-yellow-800': p.estado === 'PENDIENTE',
                            'bg-blue-100 text-blue-800': p.estado === 'ENVIADO',
                            'bg-green-100 text-green-800': p.estado === 'ENTREGADO',
                            'bg-red-100 text-red-800': p.estado === 'CANCELADO'
                          }">
                        {{p.estado}}
                    </span>
                </td>
            </ng-container>

            <!-- Columna Acciones -->
            <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let p" class="p-4">
                    <button mat-icon-button color="primary" (click)="verDetalle(p.id)" title="Ver Detalle del Pedido">
                        <mat-icon>visibility</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="eliminarPedido(p.id)" title="Eliminar Pedido">
                        <mat-icon>delete_forever</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <mat-paginator [length]="totalElements"
                       [pageSize]="pageSize"
                       [pageSizeOptions]="[5, 10, 20]"
                       aria-label="Seleccionar pÃ¡gina de pedidos">
        </mat-paginator>
    </div>
</div>